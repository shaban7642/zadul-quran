"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{4970:function(a,b,c){var d=c(4836);b.Z=void 0;var e=d(c(4938)),f=c(5893),g=(0,e.default)((0,f.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");b.Z=g},660:function(a,b,c){var d=c(4836);b.Z=void 0;var e=d(c(4938)),f=c(5893),g=(0,e.default)((0,f.jsx)("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z"}),"FileDownloadOutlined");b.Z=g},6761:function(a,b,c){var d=c(8169),e=c(5893);b.Z=(0,d.Z)((0,e.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},4150:function(a,b,c){c.d(b,{t:function(){return k}});var d=c(4727),e=c(5815),f=c(4051),g=c.n(f),h=c(5485),i=c(2071),j=function(){function a(){(0,e.Z)(this,a)}var b=a.prototype;return b.getDocuments=function(a,b,c,e){return(0,d.Z)(g().mark(function d(){return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(d,f){var g={limit:a,offset:b,documentType:c,pageName:e};try{var j=h.E.get("/documents/?".concat((0,i.K)(g)));d(j)}catch(k){f(Error("Internal server error"))}}));case 1:case"end":return d.stop()}},d)}))()},b.createDocument=function(a,b,c,e){return(0,d.Z)(g().mark(function f(){return g().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",new Promise(function(){var f=(0,d.Z)(g().mark(function d(f,i){var j;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:try{j=h.E.post('/documents/upload?data={"documentType": '.concat(JSON.stringify(a),', "userId": ').concat(c,', "reportId": ').concat(e||0,"}"),b,{contentType:"multipart/form-data"}),f(j)}catch(g){i(Error("Internal server error"))}case 1:case"end":return d.stop()}},d)}));return function(a,b){return f.apply(this,arguments)}}()));case 1:case"end":return f.stop()}},f)}))()},b.updateDocument=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){try{var e=h.E.put("/documents/".concat(a),b);c(e)}catch(f){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},b.deleteDocument=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.delete("/documents/".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},a}(),k=new j},6299:function(a,b,c){c.d(b,{Q:function(){return Q}});var d=c(4727),e=c(4251),f=c(4051),g=c.n(f),h=c(5893),i=c(7294),j=c(1796),k=c(7357),l=c(7906),m=c(295),n=c(2882),o=c(519),p=c(629),q=c(6886),r=c(155),s=c(5861),t=c(3252),u=c(3816),v=c(7922),w=c(2734),x=c(2175),y=c(3946),z=c(135),A=c(1812),B=c(6761),C=c(1134),D=c(660),E=function(a){var b=a.row,c=a.updateDocument,d=a.deleteDocument;a.labelId;var e=(0,C.ZP)(),f=(e.size,e.elapsed,e.percentage,e.download),g=(e.cancel,e.error);e.isInProgress;var j=(0,i.useState)(!1),l=j[0],m=j[1];(0,w.Z)();var n=(0,x.TA)({initialValues:{fileName:null==b?void 0:b.fileName},onSubmit:function(a){c(b.id,a),m(!1)}});return(0,i.useEffect)(function(){b&&n.setValues({fileName:null==b?void 0:b.fileName})},[b]),(0,h.jsxs)(i.Fragment,{children:[(0,h.jsxs)(u.Z,{sx:{"& > *":{borderBottom:0,cursor:"pointer"}},children:[(0,h.jsx)(t.Z,{scope:"row",onClick:function(){return m(!l)},sx:{color:"black"},children:b.fileName}),(0,h.jsxs)(t.Z,{children:[(0,h.jsx)(y.Z,{onClick:function(){return d(b.id)},sx:{p:0,ml:1,mb:1.5},children:(0,h.jsx)(B.Z,{color:"error"})}),(0,h.jsx)(y.Z,{onClick:function(){return f("https://login-api.zadulquran.com/".concat(b.fileStoragePath),b.fileName)},sx:{p:0,ml:1,mb:1.5},children:(0,h.jsx)(D.Z,{})}),g&&(0,h.jsxs)("p",{children:["possible error ",JSON.stringify(g)]})]})]}),(0,h.jsx)(u.Z,{sx:{border:0},children:(0,h.jsx)(t.Z,{style:{paddingBottom:0,paddingTop:0,border:0},colSpan:4,children:(0,h.jsx)(v.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,h.jsxs)(k.Z,{sx:{margin:1},children:[(0,h.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",sx:{margin:0},children:"edit"}),(0,h.jsxs)("form",{onSubmit:n.handleSubmit,children:[(0,h.jsx)(z.Z,{size:"small",sx:{width:{xs:"50%"},"& .MuiInputBase-root":{height:40},mr:1},error:Boolean(n.touched.fileName&&n.errors.fileName),helperText:n.touched.fileName&&n.errors.fileName,label:"file name",margin:"normal",id:"fileName",name:"fileName",type:"text",onChange:n.handleChange,value:n.values.fileName}),(0,h.jsx)(A.Z,{type:"submit",size:"medium",sx:{m:1,mt:2},variant:"contained",children:"submit"})]})]})})})})]})},F=c(3184),G=function(a){var b=a.headCells;return a.rowCount,(0,w.Z)(),(0,h.jsx)(F.Z,{sx:(0,e.Z)({width:"100%",mb:2},{bgcolor:function(a){return(0,j.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:(0,h.jsx)(u.Z,{children:b.map(function(a,b){return(0,h.jsx)(t.Z,{padding:a.disablePadding?"none":"normal",sx:{color:function(a){return a.palette.info.main}},children:a.label},a.id)})})})},H=c(7704),I=c(948),J=c(3321),K=c(4970),L=function(a){var b,c=a.createDocument,f=a.pageName,l=(0,H.a)().user,m=(0,i.useState)(!1),n=(m[0],m[1]),o=(b=(0,d.Z)(g().mark(function a(b){var d,e;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b.preventDefault(),a.prev=1,n(!0),(d=new FormData).append("userId",l.id),d.append("file",b.target.files[0],b.target.files[0].name),a.next=8,c(d,l.id);case 8:e=a.sent,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),n(!1);case 14:case"end":return a.stop()}},a,null,[[1,11]])})),function(a){return b.apply(this,arguments)}),q=(0,I.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});return(0,h.jsxs)(p.Z,{elevation:9,sx:(0,e.Z)({display:"flex",flexDirection:"column",p:"10px 10px",width:"100%"},{bgcolor:function(a){return(0,j.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:[(0,h.jsx)(k.Z,{sx:{alignItems:"center",backgroundColor:"primary.light",color:"primary.contrastText",display:"flex",justifyContent:"space-between",px:3,py:2},children:(0,h.jsx)(s.Z,{color:"inherit",variant:"h6",children:"home-work"==f?"Add Homework":"Add Document"})}),"home-work"!=f&&(null==l?void 0:l.roleId)===4?(0,h.jsx)(h.Fragment,{}):(0,h.jsx)(k.Z,{sx:{margin:1},children:(0,h.jsxs)(J.Z,{component:"label",variant:"contained",startIcon:(0,h.jsx)(K.Z,{}),children:["Upload file",(0,h.jsx)(q,{type:"file",onChange:function(a){o(a)}})]})})]})},M=L,N=c(6501),O=c(4455),P=c(4150),Q=function(a){var b,c,f,t,u=a.pageName,v=(0,i.useState)(0),w=v[0],x=v[1],y=(0,i.useState)([]),z=y[0],A=y[1],B=(0,i.useState)(null==z?void 0:z.length),C=B[0],D=B[1],F=(0,i.useState)(10),I=F[0],J=F[1],K=(0,O.s)(),L=(0,i.useCallback)((b=(0,d.Z)(g().mark(function a(b,c){var d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,P.t.getDocuments(b,c,"".concat("home-work"!=u?"books":""),u);case 3:d=a.sent,K()&&(A(d.rows),D(d.count)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),N.ZP.error(a.t0.message||"failed");case 10:case"end":return a.stop()}},a,null,[[0,7]])})),function(a,c){return b.apply(this,arguments)}),[K]),Q=(c=(0,d.Z)(g().mark(function a(b){var c,d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=N.ZP.loading("Delete Documents"),a.prev=1,a.next=4,P.t.deleteDocument(b);case 4:if(!(d=a.sent).success){a.next=12;break}return N.ZP.dismiss(c),N.ZP.success("Delete Documents "),L(I,w),a.abrupt("return",{success:!0});case 12:return N.ZP.dismiss(c),N.ZP.error("Delete DocumentsFailed"),a.abrupt("return",{success:!1});case 15:a.next=22;break;case 17:return a.prev=17,a.t0=a.catch(1),N.ZP.dismiss(c),N.ZP.error(a.t0.message||"Delete DocumentsFailed"),a.abrupt("return",{success:!1});case 22:case"end":return a.stop()}},a,null,[[1,17]])})),function(a){return c.apply(this,arguments)}),R=(0,H.a)().user,S=(f=(0,d.Z)(g().mark(function a(b,c){var d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=N.ZP.loading("createDocuments"),a.prev=1,a.next=4,P.t.createDocument({name:4===R.roleId?"home-work":"books",id:4===R.roleId?2:1},b,c);case 4:return N.ZP.dismiss(d),N.ZP.success("createDocuments "),L(I,w),a.abrupt("return",{success:!0});case 10:return a.prev=10,a.t0=a.catch(1),N.ZP.dismiss(d),N.ZP.error(a.t0.message||"createDocumentsFailed"),a.abrupt("return",{success:!1});case 15:case"end":return a.stop()}},a,null,[[1,10]])})),function(a,b){return f.apply(this,arguments)}),T=(t=(0,d.Z)(g().mark(function a(b,c){var d,e;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=N.ZP.loading("updateDocuments"),a.prev=1,a.next=4,P.t.updateDocument(b,c);case 4:if(!(e=a.sent).success){a.next=12;break}return N.ZP.dismiss(d),N.ZP.success("updateDocuments "),L(I,w),a.abrupt("return",{success:!0});case 12:return N.ZP.dismiss(d),N.ZP.error("updateDocumentsFailed"),a.abrupt("return",{success:!1});case 15:a.next=22;break;case 17:return a.prev=17,a.t0=a.catch(1),N.ZP.dismiss(d),N.ZP.error(a.t0.message||"updateDocumentsFailed"),a.abrupt("return",{success:!1});case 22:case"end":return a.stop()}},a,null,[[1,17]])})),function(a,b){return t.apply(this,arguments)}),U=[{id:"name",numeric:!1,disablePadding:!0,label:"Title"},],V=function(a,b){x(b),L(I,b*I)},W=function(a){J(parseInt(a.target.value,10)),x(0),L(parseInt(a.target.value,10),0)};return(0,i.useEffect)(function(){L(I,w)},[]),(0,h.jsx)(k.Z,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:(0,h.jsxs)(q.ZP,{container:!0,children:[(0,h.jsx)(q.ZP,{item:!0,lg:3.8,md:3.8,sm:3.8,xs:12,children:(0,h.jsx)(M,{pageName:u,createDocument:S})}),(0,h.jsx)(q.ZP,{item:!0,lg:.4,md:.4,sm:.4,xs:0,children:(0,h.jsx)(k.Z,{})}),(0,h.jsx)(q.ZP,{item:!0,lg:7.8,md:7.8,sm:7.8,xs:12,children:(0,h.jsxs)(p.Z,{elevation:9,sx:(0,e.Z)({p:"10px 10px",width:"100%"},{bgcolor:function(a){return(0,j.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:[(0,h.jsx)(r.Z,{sx:{pl:{sm:2},pr:{xs:1,sm:1}},children:(0,h.jsx)(s.Z,{sx:{flex:"1 1 100%"},variant:"h5",id:"tableTitle",component:"div",children:"home-work"==u?"Homework List":"Document List"})}),(0,h.jsx)(n.Z,{children:(0,h.jsxs)(l.Z,{sx:{minWidth:100*U.length},"aria-labelledby":"tableTitle",size:"small",children:[(0,h.jsx)(G,{headCells:U,rowCount:C}),(0,h.jsx)(m.Z,{children:null==z?void 0:z.map(function(a,b){var c="enhanced-table-checkbox-".concat(b);return(0,h.jsx)(E,{row:a,labelId:c,updateDocument:T,deleteDocument:Q},a.id)})})]})}),(0,h.jsx)(o.Z,{rowsPerPageOptions:[10,25,50],component:"div",count:C,rowsPerPage:I,page:w,onPageChange:V,onRowsPerPageChange:W})]})})]})})}},1134:function(a,b,c){c.d(b,{ZP:function(){return k}});var d=c(7294),e=c(3454),f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function g(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d.throw(a))}catch(b){f(b)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}function h(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(h){return function(i){return function(h){if(c)throw TypeError("Generator is already executing.");for(;f&&(f=0,h[0]&&(g=0)),g;)try{if(c=1,d&&(e=2&h[0]?d.return:h[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,h[1])).done)return e;switch(d=0,e&&(h=[2&h[0],e.value]),h[0]){case 0:case 1:e=h;break;case 4:return g.label++,{value:h[1],done:!1};case 5:g.label++,d=h[1],h=[0];continue;case 7:h=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===h[0]||2===h[0])){g=0;continue}if(3===h[0]&&(!e||h[1]>e[0]&&h[1]<e[3])){g.label=h[1];break}if(6===h[0]&&g.label<e[1]){g.label=e[1],e=h;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(h);break}e[2]&&g.ops.pop(),g.trys.pop();continue}h=b.call(a,g)}catch(i){h=[6,i],d=0}finally{c=e=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([h,i])}}}var i=function(a){var b=a.setSize,c=a.setControllerCallback,d=a.setPercentageCallback,e=a.setErrorCallback;return function(a){if(!a.ok)throw Error("".concat(a.status," ").concat(a.type," ").concat(a.statusText));if(!a.body)throw Error("ReadableStream not yet supported in this browser.");var f=a.body,i=a.headers.get("content-encoding"),j=a.headers.get(i?"x-file-size":"content-length"),k=parseInt(j||"0",10);b(function(){return k});var l=0,m=new ReadableStream({start:function(a){c(a);var b=f.getReader();return function c(){return g(this,void 0,void 0,function(){return h(this,function(f){return[2,b.read().then(function(b){var e=b.done,f=b.value;return e?a.close():(l+=(null==f?void 0:f.byteLength)||0,f&&a.enqueue(f),d({loaded:l,total:k}),c())}).catch(function(c){return e(c),b.cancel("Cancelled"),a.error(c)})]})})}()}});return new Response(m)}},j=function(a,b,c){var d=new Blob([a],{type:c||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)return window.navigator.msSaveBlob(d,b);var e=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(d):window.webkitURL.createObjectURL(d),f=document.createElement("a");return f.style.display="none",f.href=e,f.setAttribute("download",b),void 0===f.download&&f.setAttribute("target","_blank"),document.body.appendChild(f),f.click(),setTimeout(function(){document.body.removeChild(f),window.URL.revokeObjectURL(e)},200)};function k(a){var b=this;void 0===a&&(a={});var c=e.env.REACT_APP_DEBUG_MODE,k=(0,d.useState)(0),l=k[0],m=k[1],n=(0,d.useState)(0),o=n[0],p=n[1],q=(0,d.useState)(0),r=q[0],s=q[1],t=(0,d.useState)(null),u=t[0],v=t[1],w=(0,d.useState)(!1),x=w[0],y=w[1],z=(0,d.useRef)(null),A=(0,d.useCallback)(function(a){var b=a.loaded,c=a.total,d=Math.round(b/c*100);p(function(){return d})},[]),B=(0,d.useCallback)(function(a){var b={"Failed to execute 'enqueue' on 'ReadableStreamDefaultController': Cannot enqueue a chunk into an errored readable stream":"Download canceled","The user aborted a request.":"Download timed out"};v(function(){return{errorMessage:b[a.message]?b[a.message]:a.message}})},[]),C=(0,d.useCallback)(function(a){z.current=a},[]),D=(0,d.useCallback)(function(){z.current&&z.current.error()},[]),E=(0,d.useCallback)(function(){C(null),m(function(){return 0}),p(function(){return 0}),s(function(){return 0}),y(function(){return!1})},[C]),F=(0,d.useCallback)(function(d,e,k){return void 0===k&&(k=0),g(b,void 0,void 0,function(){var b,g,l,n;return h(this,function(h){return x?[2,null]:(E(),v(function(){return null}),y(function(){return!0}),b=setInterval(function(){return m(function(a){return a+1})},c?1:1e3),g=i({setSize:s,setControllerCallback:C,setPercentageCallback:A,setErrorCallback:B}),l=new AbortController,n=setTimeout(function(){k>0&&l.abort()},k),[2,fetch(d,f(f({},a),{method:"GET",signal:l.signal})).then(g).then(function(a){return a.blob()}).then(function(a){return j(a,e)}).then(function(){return E(),clearInterval(b)}).catch(function(a){return E(),v(function(b){return"Failed to fetch"!==a.message?{errorMessage:a.message}:b}),clearTimeout(n),clearInterval(b)})])})})},[x,E,c,C,A,B,a]);return(0,d.useMemo)(function(){return{elapsed:l,percentage:o,size:r,download:F,cancel:D,error:u,isInProgress:x}},[l,o,r,F,D,u,x])}}}])