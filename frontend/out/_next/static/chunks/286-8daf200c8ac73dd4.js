"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{8935:function(a,b,c){c.d(b,{u:function(){return k}});var d=c(4727),e=c(5815),f=c(4051),g=c.n(f),h=c(5485),i=c(2071),j=function(){function a(){(0,e.Z)(this,a)}var b=a.prototype;return b.getDepts=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){var e={limit:a,offset:b};try{var f=h.E.get("/department/?".concat((0,i.K)(e)));c(f)}catch(g){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},b.createDept=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.post("/department/create",{name:a});b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},b.updateDept=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){try{var e=h.E.put("/department/".concat(a),b);c(e)}catch(f){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},b.deleteDepts=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.delete("/department/".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},a}(),k=new j},2455:function(a,b,c){c.d(b,{B:function(){return k}});var d=c(4727),e=c(5815),f=c(4051),g=c.n(f),h=c(5485),i=c(2071),j=function(){function a(){(0,e.Z)(this,a)}var b=a.prototype;return b.getUsers=function(a,b,c,e,f){return(0,d.Z)(g().mark(function d(){return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(d,g){var j="/user/",k={limit:a,offset:b*a,roleId:c};try{if(e&&c){j="/user/?".concat((0,i.K)(k),"&roleId=").concat(e,"&roleId=").concat(f);var l=h.E.get(j);d(l)}else{var m=h.E.get("/user/?".concat((0,i.K)(k)));d(m)}}catch(n){g(Error("Internal server error"))}}));case 1:case"end":return d.stop()}},d)}))()},b.getAllParents=function(){return(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,b){try{var c=h.E.get("/user/all/parents");a(c)}catch(d){b(Error("Internal server error"))}}));case 1:case"end":return a.stop()}},a)}))()},b.getUserById=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.get("/user/".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},b.deleteUser=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.delete("/user/".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},b.createUser=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.post("/user/create",a);b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},b.updateUser=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){try{var e=h.E.put("/user/".concat(a),b);c(e)}catch(f){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},a}(),k=new j},6263:function(a,b,c){c.d(b,{Q:function(){return A}});var d=c(4727),e=c(4251),f=c(4051),g=c.n(f),h=c(5893),i=c(7294),j=c(8396),k=c(7357),l=c(7533),m=c(6501),n=c(5983),o=c(6993),p=c(1029),q=c(7292),r=c(9897),s=c(570),t=c(4455),u=c(1076),v=c(2481),w=c(7704),x=c(381),y=c.n(x),z=c(8496),A=[{value:"zoom",label:"zoom"}],B=function(){var a,b,c,f,x,A={date:{from:null,to:null},teacherId:null,departmentId:null,studentId:null},B=(0,t.s)(),C=(0,w.a)().user,D=(0,i.useRef)(null),E=(0,i.useState)([]),F=(E[0],E[1]),G=(0,i.useState)([]),H=G[0],I=G[1],J=(0,i.useState)(!1),K=J[0],L=J[1],M=(0,i.useState)({}),N=M[0],O=M[1],P=(0,j.Z)(function(a){return a.breakpoints.up("md")},{noSsr:!1}),Q=(0,i.useState)(!0),R=(Q[0],Q[1]),S=(0,i.useRef)(null),T=(0,i.useState)(P),U=T[0],V=T[1],W=function(){L(!0)},X=(0,i.useCallback)((f=(0,d.Z)(g().mark(function a(b){var c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u.Q.getSessions((0,e.Z)({},b,N));case 3:c=a.sent,B()&&I(c.rows.map(function(a){return{title:a.title||"No name",start:"".concat(null==a?void 0:a.date.substr(0,11)).concat(y()("".concat(null==a?void 0:a.date.substr(0,11)).concat(a.startTime).concat(a.date.substr(19,24))).format("HH:mm")),end:"".concat(null==a?void 0:a.date.substr(0,11)).concat(y()("".concat(a.endTime).concat(a.date.substr(19,24))).format("HH:mm"))}})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])})),function(a){return f.apply(this,arguments)}),[B]);(0,i.useEffect)(function(){X({limit:"ALL",offset:-1})},[]);var Y=(x=(0,d.Z)(g().mark(function a(b){var c,d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=m.ZP.loading("create"),a.prev=1,a.next=4,u.Q.createSession(b);case 4:if(!(d=a.sent)){a.next=12;break}return m.ZP.dismiss(c),m.ZP.success("createSessionSuccess"),X({limit:"ALL",offset:-1}),a.abrupt("return",{success:!0});case 12:return m.ZP.dismiss(c),m.ZP.error("createSessionFailed"),a.abrupt("return",{success:!1});case 15:a.next=22;break;case 17:return a.prev=17,a.t0=a.catch(1),m.ZP.dismiss(c),m.ZP.error(a.t0.message||"createSessionsFailed"),a.abrupt("return",{success:!1});case 22:case"end":return a.stop()}},a,null,[[1,17]])})),function(a){return x.apply(this,arguments)}),Z=function(a){},$=function(a){},_=function(a){F(a)},aa=function(a){O(a),X((0,e.Z)({limit:"ALL",offset:-1},a))},ab=function(){R(!0),aa(A)},ac=function(){V(function(a){return!a})},ad=function(){V(!1)};return(0,h.jsxs)(k.Z,{sx:{margin:1,display:"flex",width:"100%"},children:[["super_admin","admin"].includes(null==C?void 0:null===(a=C.role)|| void 0===a?void 0:a.name)&&(0,h.jsx)(h.Fragment,{children:P?(0,h.jsx)(k.Z,{sx:{width:U?"20%":"0%"},children:(0,h.jsx)(v.H,{containerRef:S,onClose:ad,open:U,applyFilters:function(a){return aa(a)},clearFilters:ab,isCreatePage:!0})}):(0,h.jsx)(l.ZP,{open:U,PaperProps:{sx:{width:280}},onClose:function(){V(!1)},children:(0,h.jsx)(v.H,{containerRef:S,onClose:ad,open:U,applyFilters:function(a){return aa(a)},clearFilters:ab,isCreatePage:!0})})}),(0,h.jsx)(k.Z,{sx:{m:"auto",width:U?"80%":"120%","& .fc .fc-toolbar":{flexDirection:P?"row":"column"}},children:(0,h.jsx)(n.Z,{ref:D,expandRows:!0,contentHeight:750,headerToolbar:{start:"prev,next today filterButton",center:"title",end:"addEventButton,multiMonthYear,listWeek,dayGridMonth,timeGridWeek,timeGridDay"},initialView:"dayGridMonth",plugins:[o.Z,p.Z,r.ZP,q.Z,s.Z,],editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,slotLabelFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},select:Z,eventClick:$,eventsSet:_,eventAdd:function(){},eventChange:function(){},eventRemove:function(){},events:H,customButtons:(0,e.Z)({},((null==C?void 0:null===(b=C.role)|| void 0===b?void 0:b.name)==="admin"||(null==C?void 0:null===(c=C.role)|| void 0===c?void 0:c.name)==="super_admin")&&{addEventButton:{text:"add event",click:function(a,b){W()}},filterButton:{text:"Filter",click:function(a,b){ac()}}})})}),(0,h.jsx)(z.Q,{open:K,setOpen:L,createSession:Y})]})};b.Z=B},8496:function(a,b,c){c.d(b,{Q:function(){return K}});var d=c(4727),e=c(4251),f=c(2875),g=c(4051),h=c.n(g),i=c(5893),j=c(7294),k=c(4666),l=c(7645),m=c(5861),n=c(7357),o=c(6580),p=c(6886),q=c(135),r=c(4054),s=c(8972),t=c(8295),u=c(1425),v=c(3321),w=c(1812),x=c(6310),y=c(2175),z=c(3493),A=c(586),B=c(720),C=c(4455),D=c(2455),E=c(8935),F=c(1076),G=c(381),H=c.n(G),I=c(6263),J=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"},{value:0,label:"Sunday"},],K=function(a){var b,c=a.open,g=a.setOpen,G=a.sessions,K=a.createSession,L=(0,C.s)(),M=(0,j.useState)(null),N=M[0],O=M[1],P=(0,j.useState)([]),Q=P[0],R=P[1],S=(0,j.useState)([]),T=S[0],U=S[1],V=(0,j.useState)([]),W=V[0],X=V[1],Y=(0,j.useState)([]),Z=Y[0],$=Y[1],_=(0,j.useState)(0),aa=_[0],ab=_[1],ac=(0,j.useCallback)((b=(0,d.Z)(h().mark(function a(b,c){var d,e,f;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,D.B.getUsers(b,c,"teacher","student");case 3:d=a.sent,L()&&(e=d.rows.filter(function(a){return(null==a?void 0:a.roleId)===4}),f=d.rows.filter(function(a){return(null==a?void 0:a.roleId)===3}),R(e),U(f)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])})),function(a,c){return b.apply(this,arguments)}),[L]),ad=(0,j.useCallback)((0,d.Z)(h().mark(function a(){var b;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,E.u.getDepts("ALL",-1);case 3:b=a.sent,L()&&X(b.rows),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])})),[L]),ae=(0,j.useCallback)((0,d.Z)(h().mark(function a(){var b;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,F.Q.getSessionTypes();case 3:b=a.sent,L()&&$(b.resp),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])})),[L]);(0,j.useEffect)(function(){ac("ALL",-1),ad(),ae()},[]),(0,j.useEffect)(function(){(null==G?void 0:G.length)===1&&ah.setValues((0,f.Z)((0,e.Z)({},G[0]),{frontId:G[0].frontId||""}))},[G]);var af,ag=function(){ah.resetForm(),g(!1)},ah=(0,y.TA)({initialValues:{departmentId:"",sessionTypeId:"",studentId:"",teacherId:"",toDate:"",dayOfWeek:[],endTime:"",title:"",sessionMethod:"",frontId:""},validationSchema:x.Ry({departmentId:x.Rx().required("subject is required"),sessionTypeId:x.Rx().required("session type is required"),studentId:x.Rx().required("student is required"),teacherId:x.Rx().required("teacher is required"),dayOfWeek:x.Rx().required("dayOfWeek is required"),toDate:x.hT().required("toDate is required"),endTime:x.Z_().required("endTime is required"),title:x.Z_().required("title is required"),sessionMethod:x.Z_().required("sessionMethod is required")}),onSubmit:(af=(0,d.Z)(h().mark(function a(b){var c,d,g,i,j;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=(c=new Date(String(N))).getTime(),g=H()(d),i=H()(b.endTime,"HH:mm"),a.next=6,K((0,f.Z)((0,e.Z)({},b),{frontId:"",fromDate:N,startTime:g.utc().format("HH:mm"),endTime:i.utc().format("HH:mm")}));case 6:(j=a.sent.success)&&(ag(),ah.resetForm());case 8:case"end":return a.stop()}},a)})),function(a){return af.apply(this,arguments)})});return(0,j.useEffect)(function(){var a;if(N&&(null==ah?void 0:null===(a=ah.values)|| void 0===a?void 0:a.toDate)&&ah.values.dayOfWeek){var b=new Date(N.toDate()),c=new Date(ah.values.toDate);c.setHours(23,59,59,999);var d=[],e=!0,f=!1,g=void 0;try{for(var h,i=ah.values.dayOfWeek[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){for(var j=h.value,k=new Date(b);k.getDay()!==j;)k.setDate(k.getDate()+1);for(;k<=c;)d.push(new Date(k).toISOString()),k.setDate(k.getDate()+7)}}catch(l){f=!0,g=l}finally{try{e||null==i.return||i.return()}finally{if(f)throw g}}ab((null==d?void 0:d.length)||0)}},[N,ah.values.toDate,ah.values.dayOfWeek]),(0,i.jsxs)(k.Z,{maxWidth:"md",open:c,children:[(0,i.jsx)(l.Z,{sx:{bgcolor:"primary.main",color:"white"},children:(0,i.jsx)(m.Z,{variant:"subtitle2",children:"Create patch of sessions"})}),(0,i.jsxs)(n.Z,{sx:{p:2,bgcolor:"white"},children:[null==G?void 0:G.map(function(a){var b,c;return(0,i.jsx)(m.Z,{variant:"h6",sx:{padding:"5px 0",borderBottom:"1px solid #ccc",display:"inline-block",width:"20%",textAlign:"center",cursor:"pointer",backgroundColor:(null===(b=ah.values)|| void 0===b?void 0:b.frontId)===(null==a?void 0:a.frontId)?"gray":"transparent",color:(null===(c=ah.values)|| void 0===c?void 0:c.frontId)===(null==a?void 0:a.frontId)?"white":"inherit","&:hover":{backgroundColor:"gray",color:"white"}},onClick:function(){return ah.setValues((0,f.Z)((0,e.Z)({},a),{frontId:a.frontId||""}))},children:a.title},a.frontId)}),(0,i.jsx)(o.Z,{sx:{mt:1},children:(0,i.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(q.Z,{label:"Title",name:"title",type:"text",sx:{width:"100%"},onChange:ah.handleChange,value:ah.values.title,error:Boolean(ah.errors.title&&ah.touched.title),helperText:ah.touched.title&&ah.errors.title})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(q.Z,{label:"Session Method",name:"sessionMethod",value:ah.values.sessionMethod,error:Boolean(ah.errors.sessionMethod&&ah.touched.sessionMethod),helperText:ah.touched.sessionMethod&&ah.errors.sessionMethod,InputLabelProps:{shrink:!!ah.values.sessionMethod},fullWidth:!0,required:!0,select:!0,onChange:ah.handleChange,children:I.Q.map(function(a){return(0,i.jsx)(s.Z,{value:a.value,children:a.label},a.value)})})})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(q.Z,{label:"Subject",name:"departmentId",value:ah.values.departmentId,error:Boolean(ah.errors.departmentId&&ah.touched.departmentId),helperText:ah.touched.departmentId&&ah.errors.departmentId,InputLabelProps:{shrink:!!ah.values.departmentId},fullWidth:!0,required:!0,select:!0,onChange:ah.handleChange,children:W.map(function(a){return(0,i.jsx)(s.Z,{value:a.id,children:a.name},a.id)})})})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(q.Z,{label:"Teacher",name:"teacherId",value:ah.values.teacherId,error:Boolean(ah.errors.teacherId&&ah.touched.teacherId),helperText:ah.touched.teacherId&&ah.errors.teacherId,InputLabelProps:{shrink:!!ah.values.teacherId},fullWidth:!0,required:!0,select:!0,onChange:ah.handleChange,children:T.map(function(a){return(0,i.jsxs)(s.Z,{value:a.id,children:[a.firstName," ",a.lastName]},a.id)})})})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(t.Z,{options:Q,getOptionLabel:function(a){return"".concat(a.firstName," ").concat(a.lastName)},value:Q.find(function(a){return a.id===ah.values.studentId})||null,onChange:function(a,b){ah.setFieldValue("studentId",b?b.id:"")},renderInput:function(a){return(0,i.jsx)(q.Z,(0,f.Z)((0,e.Z)({},a),{label:"Student",name:"studentId",error:Boolean(ah.errors.studentId&&ah.touched.studentId),required:!0,helperText:ah.touched.studentId&&ah.errors.studentId}))}})})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(B._,{dateAdapter:A.y,children:(0,i.jsx)(z.x,{name:"fromDate",sx:{width:"100%"},label:"From Date & Start Time",value:N,onChange:function(a){O(a)}})})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(q.Z,{label:"To Date",name:"toDate",type:"date",sx:{width:"100%"},onChange:ah.handleChange,value:ah.values.toDate,error:Boolean(ah.errors.toDate&&ah.touched.toDate),helperText:ah.touched.toDate&&ah.errors.toDate,InputLabelProps:{shrink:!0}})}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(q.Z,{label:"End Time",name:"endTime",type:"time",sx:{width:"100%"},onChange:ah.handleChange,value:ah.values.endTime,error:Boolean(ah.errors.endTime&&ah.touched.endTime),helperText:ah.touched.endTime&&ah.errors.endTime,InputLabelProps:{shrink:!0}})}),(0,i.jsxs)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:[(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(q.Z,{label:"Day of week",name:"dayOfWeek",value:Array.isArray(ah.values.dayOfWeek)?ah.values.dayOfWeek:[],error:Boolean(ah.errors.dayOfWeek&&ah.touched.dayOfWeek),helperText:ah.touched.dayOfWeek&&ah.errors.dayOfWeek,InputLabelProps:{shrink:!!ah.values.dayOfWeek},fullWidth:!0,required:!0,select:!0,onChange:ah.handleChange,SelectProps:{multiple:!0},children:J.map(function(a){return(0,i.jsx)(s.Z,{value:a.value,children:a.label},a.value)})})}),aa>0&&(0,i.jsxs)(m.Z,{color:"primary",sx:{mt:2},children:["Number of sessions: ",String(aa)]})]}),(0,i.jsx)(p.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,i.jsx)(r.Z,{fullWidth:!0,children:(0,i.jsx)(q.Z,{label:"Session Type",name:"sessionTypeId",value:ah.values.sessionTypeId,error:Boolean(ah.errors.sessionTypeId&&ah.touched.sessionTypeId),helperText:ah.touched.sessionTypeId&&ah.errors.sessionTypeId,InputLabelProps:{shrink:!!ah.values.sessionTypeId},fullWidth:!0,required:!0,select:!0,onChange:ah.handleChange,children:Z.map(function(a){return(0,i.jsx)(s.Z,{value:a.id,children:a.name},a.id)})})})})]})}),(0,i.jsx)(u.Z,{sx:{p:3},children:(0,i.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[(0,i.jsxs)(v.Z,{variant:"outlined",size:"small",onClick:ag,children:[" ","Cancel"]}),(0,i.jsx)(w.Z,{type:"submit",variant:"contained",onClick:function(){return ah.handleSubmit()},children:"Create"})]})})]})]})}},2481:function(a,b,c){c.d(b,{H:function(){return J}});var d=c(4727),e=c(7573),f=c(4251),g=c(2875),h=c(4747),i=c(969),j=c(4051),k=c.n(j),l=c(5893),m=c(7294),n=c(5697),o=c.n(n),p=c(7533),q=c(8396),r=c(7357),s=c(4054),t=c(8295),u=c(135),v=c(7109),w=c(5861),x=c(3321),y=c(948),z=c(1812),A=c(2761),B=c(720),C=c(2740),D=c(1163),E=c(2455),F=c(4455),G=c(8935),H=(0,y.ZP)(p.ZP)({flexShrink:0,width:305,"& .MuiDrawer-paper":{position:"relative",width:305,backgroundColor:"white"}}),I=(0,y.ZP)(p.ZP)({maxWidth:"100%",width:305,"& .MuiDrawer-paper":{height:"calc(100% - 64px)",maxWidth:"100%",top:64,width:305}}),J=function(a){var b,c,j,n=a.containerRef,o=a.onClose,p=a.open,y=a.applyFilters,J=a.clearFilters,K=a.loading,L=a.isCreatePage,M=(0,h.Z)(a,["containerRef","onClose","open","applyFilters","clearFilters","loading","isCreatePage"]),N=(0,D.useRouter)(),O=(0,F.s)(),P=(0,q.Z)(function(a){return a.breakpoints.up("lg")}),Q=(0,m.useMemo)(function(){return{date:{from:null,to:null},teacherId:null,departmentId:null,studentId:Number(N.query.student)||null}},[N.query.student]),R=(0,m.useState)(Q),S=R[0],T=R[1],U=(0,m.useState)([]),V=U[0],W=U[1],X=(0,m.useState)([]),Y=X[0],Z=X[1],$=(0,m.useState)([]),_=$[0],aa=$[1],ab=(0,m.useState)(!1),ac=ab[0],ad=ab[1],ae=(0,m.useState)(!1),af=ae[0],ag=ae[1],ah=(0,m.useCallback)((0,d.Z)(k().mark(function a(){var b,c,d;return k().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,ad(!0),ag(!0),a.t0=i.Z,a.next=6,Promise.all([E.B.getUsers("All",0,"teacher","student"),G.u.getDepts("All",-1),]);case 6:a.t1=a.sent,c=(b=(0,a.t0)(a.t1,2))[0],d=b[1],O()&&(W(c.rows.filter(function(a){return 3===a.roleId})),Z(c.rows.filter(function(a){return 4===a.roleId})),aa(d.rows)),a.next=16;break;case 13:a.prev=13,a.t2=a.catch(0),console.error("Error fetching filter data:",a.t2);case 16:return a.prev=16,ad(!1),ag(!1),a.finish(16);case 20:case"end":return a.stop()}},a,null,[[0,13,16,20]])})),[O]);(0,m.useEffect)(function(){ah()},[ah]),(0,m.useEffect)(function(){if(N.query.student){var a=Number(N.query.student);isNaN(a)||T(function(b){return(0,g.Z)((0,f.Z)({},b),{studentId:a})})}},[N.query.student]);var ai=function(a){return function(b){var c=b.target.value,d=c?new Date(c):null;T(function(b){return(0,g.Z)((0,f.Z)({},b),{date:(0,g.Z)((0,f.Z)({},b.date),(0,e.Z)({},a,d))})})}},aj=function(a){return function(b,c){var d;T(function(b){return(0,g.Z)((0,f.Z)({},b),(0,e.Z)({},a,null!==(d=null==c?void 0:c.id)&& void 0!==d?d:null))})}},ak=function(){T(Q),null==J||J()},al=(0,l.jsxs)(r.Z,{sx:{p:3},children:[(0,l.jsx)(s.Z,{fullWidth:!0,sx:{mb:3},children:(0,l.jsx)(t.Z,{options:V,loading:ac,getOptionLabel:function(a){return"".concat(a.firstName," ").concat(a.lastName)},value:V.find(function(a){return a.id===S.teacherId})||null,onChange:aj("teacherId"),isOptionEqualToValue:function(a,b){return a.id===b.id},renderInput:function(a){return(0,l.jsx)(u.Z,(0,g.Z)((0,f.Z)({},a),{label:"Teacher",InputProps:(0,g.Z)((0,f.Z)({},a.InputProps),{startAdornment:(0,l.jsx)(v.Z,{position:"start",children:(0,l.jsx)(A.Z,{fontSize:"small"})})})}))}})}),(0,l.jsx)(s.Z,{fullWidth:!0,sx:{mb:3},children:(0,l.jsx)(t.Z,{options:Y,loading:af,getOptionLabel:function(a){return"".concat(a.firstName," ").concat(a.lastName)},value:Y.find(function(a){return a.id===S.studentId})||null,onChange:aj("studentId"),isOptionEqualToValue:function(a,b){return a.id===b.id},renderInput:function(a){return(0,l.jsx)(u.Z,(0,g.Z)((0,f.Z)({},a),{label:"Student",InputProps:(0,g.Z)((0,f.Z)({},a.InputProps),{startAdornment:(0,l.jsx)(v.Z,{position:"start",children:(0,l.jsx)(A.Z,{fontSize:"small"})})})}))}})}),(0,l.jsx)(s.Z,{fullWidth:!0,sx:{mb:3},children:(0,l.jsx)(t.Z,{options:_,getOptionLabel:function(a){return a.name},value:_.find(function(a){return a.id===S.departmentId})||null,onChange:aj("departmentId"),isOptionEqualToValue:function(a,b){return a.id===b.id},renderInput:function(a){return(0,l.jsx)(u.Z,(0,g.Z)((0,f.Z)({},a),{label:"Subject",InputProps:(0,g.Z)((0,f.Z)({},a.InputProps),{startAdornment:(0,l.jsx)(v.Z,{position:"start",children:(0,l.jsx)(A.Z,{fontSize:"small"})})})}))}})}),(0,l.jsx)(w.Z,{variant:"subtitle2",color:"textSecondary",sx:{mb:2},children:"Date Range"}),(0,l.jsx)(B._,{dateAdapter:C.H,children:(0,l.jsxs)(r.Z,{display:"flex",gap:2,mb:4,children:[(0,l.jsx)(u.Z,{fullWidth:!0,type:"date",label:"From",InputLabelProps:{shrink:!0},value:(null===(b=S.date.from)|| void 0===b?void 0:b.toISOString().split("T")[0])||"",onChange:ai("from")}),(0,l.jsx)(u.Z,{fullWidth:!0,type:"date",label:"To",InputLabelProps:{shrink:!0},value:(null===(c=S.date.to)|| void 0===c?void 0:c.toISOString().split("T")[0])||"",onChange:ai("to"),disabled:!S.date.from,inputProps:{min:null===(j=S.date.from)|| void 0===j?void 0:j.toISOString().split("T")[0]}})]})}),(0,l.jsx)(z.Z,{fullWidth:!0,loading:K,variant:"contained",onClick:function(){return y(S)},children:"Apply Filters"}),(0,l.jsx)(x.Z,{fullWidth:!0,sx:{mt:2},variant:"outlined",onClick:ak,children:"Clear Filters"})]});return L?p?(0,l.jsx)(r.Z,{children:al}):(0,l.jsx)(r.Z,{sx:{width:"0px"}}):P?(0,l.jsx)(H,(0,g.Z)((0,f.Z)({anchor:"left",open:p,SlideProps:{container:null==n?void 0:n.current},variant:"persistent"},M),{children:al})):(0,l.jsx)(I,(0,g.Z)((0,f.Z)({anchor:"left",ModalProps:{container:null==n?void 0:n.current},onClose:o,open:p,SlideProps:{container:null==n?void 0:n.current},variant:"temporary"},M),{children:al}))};J.propTypes={containerRef:o().any,onClose:o().func,open:o().bool,applyFilters:o().func.isRequired,clearFilters:o().func,loading:o().bool,isCreatePage:o().bool}}}])