(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{715:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/roles/[id]",function(){return c(3754)}])},5535:function(a,b,c){"use strict";c.d(b,{h:function(){return j}});var d=c(4727),e=c(5815),f=c(4051),g=c.n(f),h=c(5485),i=function(){function a(){(0,e.Z)(this,a)}var b=a.prototype;return b.getRoles=function(){return(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,b){try{var c=h.E.get("/settings/all/roles");a(c)}catch(d){b(Error("Internal server error"))}}));case 1:case"end":return a.stop()}},a)}))()},b.getAllPermissions=function(){return(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,b){try{var c=h.E.get("/settings/all/permissions");a(c)}catch(d){b(Error("Internal server error"))}}));case 1:case"end":return a.stop()}},a)}))()},b.getRolePermissions=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.get("/settings/all/rolePermissions/?roleId=".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},b.addPermissions=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){try{var e=h.E.post("/settings/add/permission",{permissionIds:a,roleId:b});c(e)}catch(f){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},b.removePermissions=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=h.E.post("/settings/remove/permission",{rolePermissionsIds:a});b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},a}(),j=new i},5086:function(a,b,c){"use strict";c.d(b,{t:function(){return j}});var d=c(5893),e=c(7294),f=c(1163),g=c(5697),h=c.n(g),i=c(7704),j=function(a){var b=a.children,c=(0,i.a)().user,g=(0,f.useRouter)(),h=(0,e.useState)(!1),j=h[0],k=h[1];return((0,e.useEffect)(function(){g.isReady&&((null==c?void 0:c.roleId)!==1?g.push({pathname:"/sessions",query:{returnUrl:g.asPath}}).catch(console.error):k(!0))},[g.isReady]),j)?(0,d.jsx)(d.Fragment,{children:b}):null};j.propTypes={children:h().node}},1910:function(a,b,c){"use strict";c.d(b,{m:function(){return k}});var d=c(4251),e=c(5893),f=c(2734),g=c(1796),h=c(3252),i=c(3184),j=c(3816),k=function(a){var b=a.headCells;return(0,f.Z)(),(0,e.jsx)(i.Z,{sx:(0,d.Z)({width:"100%",mb:2},{bgcolor:function(a){return(0,g.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:(0,e.jsx)(j.Z,{children:b.map(function(a,b){return(0,e.jsx)(h.Z,{padding:a.disablePadding?"none":"normal",sx:{color:function(a){return a.palette.info.main}},children:a.label},a.id)})})})}},3754:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return N}});var d=c(5893),e=c(1163),f=c(9633),g=c(4727),h=c(4251),i=c(2875),j=c(9779),k=c(4051),l=c.n(k),m=c(7294),n=c(1796),o=c(7357),p=c(7906),q=c(295),r=c(2882),s=c(629),t=c(155),u=c(5861),v=c(7720),w=c(7918),x=c(3252),y=c(3816),z=c(6420),A=c(8166),B=c(9737),C=c(3740),D=function(a){var b,c,e=a.row,f=a.labelId,g=a.checked,h=a.sentPermissions,i=(0,m.useState)(g),j=i[0],k=i[1],l=function(a,b){a.preventDefault(),h(j,b.permissionId,b.rolePermissionId),k(!j)};return(0,d.jsx)(m.Fragment,{children:(0,d.jsxs)(y.Z,{sx:{"& > *":{border:0,p:1,pl:4}},children:[(0,d.jsx)(x.Z,{scope:"row",children:(c=e.name.replace(/.*:/,""),"create"==c?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(u.Z,{sx:{background:"rgba(0,170,89,0.11)",color:"#00AA59",display:"inline-block",p:"5px",fontSize:"16px",fontWeight:"600",borderRadius:"5px"},children:c.toUpperCase()})}):"delete"==c?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(u.Z,{sx:{background:"rgba(255,0,0,0.11)",color:"#FF0000",display:"inline-block",p:"5px",fontSize:"16px",fontWeight:"600",borderRadius:"5px"},children:c.toUpperCase()})}):"read"==c?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(u.Z,{sx:{background:"rgba(0,0,255,0.11)",color:"#0000FF",display:"inline-block",p:"5px",fontSize:"16px",fontWeight:"600",borderRadius:"5px"},children:c.toUpperCase()})}):"update"==c?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(u.Z,{sx:{background:"rgba(255,165,0,0.11)",color:"#FFA500",display:"inline-block",p:"5px",fontSize:"16px",fontWeight:"600",borderRadius:"5px"},children:c.toUpperCase()})}):void 0)}),(0,d.jsx)(x.Z,{scope:"row",children:(0,d.jsx)(z.Z,{"aria-label":f,sx:{border:"none"},value:{permissionId:e.id,rolePermissionId:null===(b=e.rolePermission)|| void 0===b?void 0:b.id},selected:j,onChange:l,children:j?(0,d.jsx)(A.Z,{title:"remove",children:(0,d.jsx)(B.Z,{})}):(0,d.jsx)(A.Z,{title:"add",children:(0,d.jsx)(C.Z,{})})})})]})})},E=c(1910),F=c(6501),G=c(4455),H=c(5535),I=c(8987),J=function(a){var b,c,e,f=a.roleId,k=a.role,x=a.name,y=(0,m.useState)([]),z=y[0],A=y[1],B=(0,m.useState)([]),C=B[0],J=B[1],K=(0,m.useState)(),L=K[0],M=K[1],N=(0,m.useState)([]),O=N[0],P=N[1],Q=(0,m.useState)([]),R=Q[0],S=Q[1],T=function(a,b,c){if(a)(null==R||!R.includes(c))&&((null==O?void 0:O.includes(c))&&P(O.filter(function(a){return a!==c})),S((0,j.Z)(R).concat([c])));else{if(null==O?void 0:O.includes(b))return;(null==R?void 0:R.includes(b))&&S(R.filter(function(a){return a!==b})),P((0,j.Z)(O).concat([b]))}},U=(0,G.s)(),V=(0,m.useCallback)((0,g.Z)(l().mark(function a(){var b,c;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,H.h.getAllPermissions();case 3:b=a.sent,U()&&A(null===(c=b.resp)|| void 0===c?void 0:c.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),F.ZP.error(a.t0.message||"failed");case 10:case"end":return a.stop()}},a,null,[[0,7]])})),[U]),W=(0,m.useCallback)((0,g.Z)(l().mark(function a(){var b;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,H.h.getRolePermissions(x);case 3:b=a.sent,U()&&(J(b.rows),X()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),F.ZP.error(a.t0.message||"failed");case 10:case"end":return a.stop()}},a,null,[[0,7]])})),[U]),X=function(){M(z.map(function(a,b){return(0,i.Z)((0,h.Z)({},a),{matched:C.some(function(b){return b.permissionId===a.id}),rolePermission:C.find(function(b){return b.permissionId===a.id})})}))},Y=(b=(0,g.Z)(l().mark(function a(b,c){var d;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,H.h.addPermissions(b,c);case 3:d=a.sent,a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),F.ZP.error(a.t0.message||"addPermissionsFailed");case 9:case"end":return a.stop()}},a,null,[[0,6]])})),function(a,c){return b.apply(this,arguments)}),Z=(c=(0,g.Z)(l().mark(function a(b){var c,d;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=F.ZP.loading("removePremissions"),a.prev=1,a.next=4,H.h.removePermissions(b);case 4:if(!(d=a.sent).success){a.next=11;break}return F.ZP.dismiss(c),F.ZP.success("removePremissions "),a.abrupt("return",{success:!0});case 11:return F.ZP.dismiss(c),F.ZP.error("removePremissionsFailed"),a.abrupt("return",{success:!1});case 14:a.next=21;break;case 16:return a.prev=16,a.t0=a.catch(1),F.ZP.dismiss(c),F.ZP.error(a.t0.message||"removePremissionsFailed"),a.abrupt("return",{success:!1});case 21:case"end":return a.stop()}},a,null,[[1,16]])})),function(a){return c.apply(this,arguments)}),$=(e=(0,g.Z)(l().mark(function a(b){return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b.preventDefault(),!(O.length>0)){a.next=5;break}return a.next=4,Y(O,f);case 4:P([]);case 5:if(!(R.length>0)){a.next=9;break}return a.next=8,Z(R);case 8:S([]);case 9:(O.length>0||R.length>0)&&W();case 10:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)});return(0,m.useEffect)(function(){V()},[]),(0,m.useEffect)(function(){W()},[f]),(0,m.useEffect)(function(){(null==z?void 0:z.length)>0&&(null==C?void 0:C.length)>=0&&X()},[z,C]),(0,d.jsx)(o.Z,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:(0,d.jsxs)(s.Z,{elevation:9,sx:(0,h.Z)({p:"10px 10px",width:"100%"},{bgcolor:function(a){return(0,n.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:[" ",(0,d.jsx)(t.Z,{sx:{pl:{sm:2},pr:{xs:1,sm:1}},children:(0,d.jsxs)(u.Z,{sx:{flex:"1 1 100%"},variant:"h5",id:"tableTitle",component:"div",children:["Permissions List for : ",k]})}),(0,d.jsx)(r.Z,{children:(0,d.jsxs)(p.Z,{"aria-labelledby":"tableTitle",size:"small",children:[(0,d.jsx)(E.m,{headCells:[{id:"permission",numeric:!1,disablePadding:!0,label:"Permission"},{id:"action",numeric:!1,disablePadding:!0,label:"Action"},]}),(0,d.jsx)(q.Z,{children:null==L?void 0:L.map(function(a,b){var c="enhanced-table-checkbox-".concat(b);return(0,d.jsxs)(d.Fragment,{children:[b%4==0?(0,d.jsx)(v.Z,{textAlign:"center",sx:{width:"138%"},children:(0,d.jsx)(w.Z,{label:"".concat(a.name.replace(/:.*/,"").toLocaleUpperCase()," Permissions"),sx:{fontWeight:"600"}})}):(0,d.jsx)(v.Z,{sx:{width:"138%"}}),(0,d.jsx)(D,{row:a,labelId:c,checked:null==a?void 0:a.matched,sentPermissions:T},null==a?void 0:a.id)]})})})]})}),(0,d.jsx)("div",{style:{textAlign:"right"},children:(0,d.jsx)(I.Z,{type:"button",onClick:$,sx:{"& .MuiInputBase-root":{height:40},m:.5,p:1},variant:"contained",children:"Save"})})]})})},K=c(1132),L=c(5086),M=function(){var a=(0,e.useRouter)().query,b=a.id,c=a.role,f=a.name;return(0,d.jsx)(J,{role:String(c),roleId:Number(b),name:String(f)})};M.getLayout=function(a){return(0,d.jsx)(K.a,{children:(0,d.jsx)(L.t,{children:(0,d.jsx)(f.c,{children:a})})})};var N=M}},function(a){a.O(0,[805,486,411,720,504,723,774,888,179],function(){var b;return a(a.s=715)}),_N_E=a.O()}])