(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[976],{6761:function(a,b,c){"use strict";var d=c(8169),e=c(5893);b.Z=(0,d.Z)((0,e.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},7070:function(a,b,c){"use strict";c(7294);var d=c(8169),e=c(5893);b.Z=(0,d.Z)((0,e.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},6686:function(a,b,c){"use strict";c(7294);var d=c(8169),e=c(5893);b.Z=(0,d.Z)((0,e.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},1289:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/documents",function(){return c(4497)}])},4150:function(a,b,c){"use strict";c.d(b,{t:function(){return l}});var d=c(4727),e=c(5815),f=c(4051),g=c.n(f),h=c(6154),i=c(5485),j=c(2071),k=function(){function a(){(0,e.Z)(this,a)}var b=a.prototype;return b.getDocuments=function(a,b,c){return(0,d.Z)(g().mark(function d(){return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(d,e){var f={limit:a,offset:b,documentType:c};try{var g=i.E.get("/documents/?".concat((0,j.K)(f)));d(g)}catch(h){e(Error("Internal server error"))}}));case 1:case"end":return d.stop()}},d)}))()},b.createDocument=function(a,b,c){return(0,d.Z)(g().mark(function e(){return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,d.Z)(g().mark(function d(e,f){var i;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,console.log(a),d.next=4,h.Z.post('http://localhost:4000/api/documents/upload?data={"documentType": '.concat(JSON.stringify(a),', "userId": ').concat(c,"}"),b,{headers:{"Content-Type":"multipart/form-data"}});case 4:e(i=d.sent),d.next=11;break;case 8:d.prev=8,d.t0=d.catch(0),f(Error("Internal server error"));case 11:case"end":return d.stop()}},d,null,[[0,8]])}));return function(a,b){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}))()},b.updateDocument=function(a,b){return(0,d.Z)(g().mark(function c(){return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",new Promise(function(c,d){try{var e=i.E.put("/documents/".concat(a),b);c(e)}catch(f){d(Error("Internal server error"))}}));case 1:case"end":return c.stop()}},c)}))()},b.deleteDocument=function(a){return(0,d.Z)(g().mark(function b(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(b,c){try{var d=i.E.delete("/documents/".concat(a));b(d)}catch(e){c(Error("Internal server error"))}}));case 1:case"end":return b.stop()}},b)}))()},a}(),l=new k},4497:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return U}});var d=c(5893),e=c(9633),f=c(7357),g=c(4727),h=c(4251),i=c(4051),j=c.n(i),k=c(7294),l=c(1796),m=c(7906),n=c(295),o=c(2882),p=c(519),q=c(629),r=c(6886),s=c(155),t=c(5861),u=c(3252),v=c(3816),w=c(7922),x=c(2734),y=c(2175),z=c(3946),A=c(135),B=c(8987),C=c(6761),D=c(1134),E=c(660),F=function(a){var b=a.row,c=a.updateDocument,e=a.deleteDocument;a.labelId;var g=(0,D.ZP)(),h=(g.size,g.elapsed,g.percentage,g.download),i=(g.cancel,g.error);g.isInProgress;var j=(0,k.useState)(!1),l=j[0],m=j[1];(0,x.Z)();var n=(0,y.TA)({initialValues:{fileName:null==b?void 0:b.fileName},onSubmit:function(a){c(b.id,a),m(!1)}});return(0,k.useEffect)(function(){b&&n.setValues({fileName:null==b?void 0:b.fileName})},[b]),(0,d.jsxs)(k.Fragment,{children:[(0,d.jsxs)(v.Z,{sx:{"& > *":{borderBottom:0,cursor:"pointer"}},children:[(0,d.jsx)(u.Z,{scope:"row",onClick:function(){return m(!l)},sx:{color:"black"},children:b.fileName}),(0,d.jsxs)(u.Z,{children:[(0,d.jsx)(z.Z,{onClick:function(){return e(b.id)},sx:{p:0,ml:1,mb:1.5},children:(0,d.jsx)(C.Z,{color:"error"})}),(0,d.jsx)(z.Z,{onClick:function(){return h("http://localhost:4000/".concat(b.fileStoragePath),b.fileName)},sx:{p:0,ml:1,mb:1.5},children:(0,d.jsx)(E.Z,{})}),i&&(0,d.jsxs)("p",{children:["possible error ",JSON.stringify(i)]})]})]}),(0,d.jsx)(v.Z,{sx:{border:0},children:(0,d.jsx)(u.Z,{style:{paddingBottom:0,paddingTop:0,border:0},colSpan:4,children:(0,d.jsx)(w.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,d.jsxs)(f.Z,{sx:{margin:1},children:[(0,d.jsx)(t.Z,{variant:"h6",gutterBottom:!0,component:"div",sx:{margin:0},children:"edit"}),(0,d.jsxs)("form",{onSubmit:n.handleSubmit,children:[(0,d.jsx)(A.Z,{size:"small",sx:{width:{xs:"50%"},"& .MuiInputBase-root":{height:40},mr:1},error:Boolean(n.touched.fileName&&n.errors.fileName),helperText:n.touched.fileName&&n.errors.fileName,label:"file name",margin:"normal",id:"fileName",name:"fileName",type:"text",onChange:n.handleChange,value:n.values.fileName}),(0,d.jsx)(B.Z,{type:"submit",size:"medium",sx:{m:1,mt:2},variant:"contained",children:"submit"})]})]})})})})]})},G=c(3184),H=function(a){var b=a.headCells;return a.rowCount,(0,x.Z)(),(0,d.jsx)(G.Z,{sx:(0,h.Z)({width:"100%",mb:2},{bgcolor:function(a){return(0,l.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:(0,d.jsx)(v.Z,{children:b.map(function(a,b){return(0,d.jsx)(u.Z,{padding:a.disablePadding?"none":"normal",sx:{color:function(a){return a.palette.info.main}},children:a.label},a.id)})})})},I=c(7704),J=c(948),K=c(3321),L=c(4970),M=function(a){var b,c=a.createDocument,e=(0,I.a)().user,i=(0,k.useState)(!1),m=(i[0],i[1]),n=(b=(0,g.Z)(j().mark(function a(b){var d,f;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b.preventDefault(),a.prev=1,console.log("file",b.target.files[0]),m(!0),(d=new FormData).append("userId",e.id),d.append("file",b.target.files[0]),a.next=9,c(d,e.id);case 9:f=a.sent,a.next=16;break;case 12:a.prev=12,a.t0=a.catch(1),console.log(a.t0),m(!1);case 16:case"end":return a.stop()}},a,null,[[1,12]])})),function(a){return b.apply(this,arguments)}),o=(0,J.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});return(0,d.jsxs)(q.Z,{elevation:9,sx:(0,h.Z)({display:"flex",flexDirection:"column",p:"10px 10px",width:"100%"},{bgcolor:function(a){return(0,l.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:[(0,d.jsx)(f.Z,{sx:{alignItems:"center",backgroundColor:"primary.light",color:"primary.contrastText",display:"flex",justifyContent:"space-between",px:3,py:2},children:(0,d.jsx)(t.Z,{color:"inherit",variant:"h6",children:"Add Document"})}),(0,d.jsx)(f.Z,{sx:{margin:1},children:(0,d.jsxs)(K.Z,{component:"label",variant:"contained",startIcon:(0,d.jsx)(L.Z,{}),children:["Upload file",(0,d.jsx)(o,{type:"file",onChange:function(a){n(a)}})]})})]})},N=M,O=c(6501),P=c(4455),Q=c(4150),R=function(){var a,b,c,e,i=(0,k.useState)(0),u=i[0],v=i[1],w=(0,k.useState)([]),x=w[0],y=w[1],z=(0,k.useState)(null==x?void 0:x.length),A=z[0],B=z[1],C=(0,k.useState)(10),D=C[0],E=C[1],G=(0,P.s)(),I=(0,k.useCallback)((a=(0,g.Z)(j().mark(function a(b,c){var d;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Q.t.getDocuments(b,c,"books");case 3:d=a.sent,G()&&(y(d.rows),B(d.count)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),O.ZP.error(a.t0.message||"failed");case 10:case"end":return a.stop()}},a,null,[[0,7]])})),function(b,c){return a.apply(this,arguments)}),[G]),J=(b=(0,g.Z)(j().mark(function a(b){var c,d;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=O.ZP.loading("Delete Documents"),a.prev=1,a.next=4,Q.t.deleteDocument(b);case 4:if(!(d=a.sent).success){a.next=12;break}return O.ZP.dismiss(c),O.ZP.success("Delete Documents "),I(D,u),a.abrupt("return",{success:!0});case 12:return O.ZP.dismiss(c),O.ZP.error("Delete DocumentsFailed"),a.abrupt("return",{success:!1});case 15:a.next=22;break;case 17:return a.prev=17,a.t0=a.catch(1),O.ZP.dismiss(c),O.ZP.error(a.t0.message||"Delete DocumentsFailed"),a.abrupt("return",{success:!1});case 22:case"end":return a.stop()}},a,null,[[1,17]])})),function(a){return b.apply(this,arguments)}),K=(c=(0,g.Z)(j().mark(function a(b,c){var d;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=O.ZP.loading("createDocuments"),a.prev=1,console.log({values:b}),a.next=5,Q.t.createDocument({name:"books",id:1},b,c);case 5:return O.ZP.dismiss(d),O.ZP.success("createDocuments "),I(D,u),a.abrupt("return",{success:!0});case 11:return a.prev=11,a.t0=a.catch(1),O.ZP.dismiss(d),O.ZP.error(a.t0.message||"createDocumentsFailed"),a.abrupt("return",{success:!1});case 16:case"end":return a.stop()}},a,null,[[1,11]])})),function(a,b){return c.apply(this,arguments)}),L=(e=(0,g.Z)(j().mark(function a(b,c){var d,e;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=O.ZP.loading("updateDocuments"),a.prev=1,a.next=4,Q.t.updateDocument(b,c);case 4:if(!(e=a.sent).success){a.next=12;break}return O.ZP.dismiss(d),O.ZP.success("updateDocuments "),I(D,u),a.abrupt("return",{success:!0});case 12:return O.ZP.dismiss(d),O.ZP.error("updateDocumentsFailed"),a.abrupt("return",{success:!1});case 15:a.next=22;break;case 17:return a.prev=17,a.t0=a.catch(1),O.ZP.dismiss(d),O.ZP.error(a.t0.message||"updateDocumentsFailed"),a.abrupt("return",{success:!1});case 22:case"end":return a.stop()}},a,null,[[1,17]])})),function(a,b){return e.apply(this,arguments)}),M=[{id:"name",numeric:!1,disablePadding:!0,label:"Title"},],R=function(a,b){v(b),I(D,b*D)},S=function(a){E(parseInt(a.target.value,10)),v(0),I(parseInt(a.target.value,10),0)};return(0,k.useEffect)(function(){I(D,u)},[]),(0,d.jsx)(f.Z,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:(0,d.jsxs)(r.ZP,{container:!0,children:[(0,d.jsx)(r.ZP,{item:!0,lg:3.8,md:3.8,sm:3.8,xs:12,children:(0,d.jsx)(N,{createDocument:K})}),(0,d.jsx)(r.ZP,{item:!0,lg:.4,md:.4,sm:.4,xs:0,children:(0,d.jsx)(f.Z,{})}),(0,d.jsx)(r.ZP,{item:!0,lg:7.8,md:7.8,sm:7.8,xs:12,children:(0,d.jsxs)(q.Z,{elevation:9,sx:(0,h.Z)({p:"10px 10px",width:"100%"},{bgcolor:function(a){return(0,l.Fq)(a.palette.info.contrastText,a.palette.action.activatedOpacity)}}),children:[" ",(0,d.jsx)(s.Z,{sx:{pl:{sm:2},pr:{xs:1,sm:1}},children:(0,d.jsx)(t.Z,{sx:{flex:"1 1 100%"},variant:"h5",id:"tableTitle",component:"div",children:"Document List"})}),(0,d.jsx)(o.Z,{children:(0,d.jsxs)(m.Z,{sx:{minWidth:100*M.length},"aria-labelledby":"tableTitle",size:"small",children:[(0,d.jsx)(H,{headCells:M,rowCount:A}),(0,d.jsx)(n.Z,{children:null==x?void 0:x.map(function(a,b){var c="enhanced-table-checkbox-".concat(b);return(0,d.jsx)(F,{row:a,labelId:c,updateDocument:L,deleteDocument:J},a.id)})})]})}),(0,d.jsx)(p.Z,{rowsPerPageOptions:[10,25,50],component:"div",count:A,rowsPerPage:D,page:u,onPageChange:R,onRowsPerPageChange:S})]})})]})})},S=c(1132),T=function(){return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(f.Z,{sx:{width:"100%",typography:"body1"},children:(0,d.jsx)(R,{})})})};T.getLayout=function(a){return(0,d.jsx)(S.a,{children:(0,d.jsx)(e.c,{children:a})})};var U=T},2071:function(a,b,c){"use strict";c.d(b,{K:function(){return e}});var d=c(6486),e=function(a){var b=Object.keys(a),c=[];return a?(b.forEach(function(b){((0,d.isEmpty)(a[b])||(0,d.isNil)(a[b]))&&"number"!=typeof a[b]||c.push("".concat(b,"=").concat(a[b])),("archived"===b||"exported"===b)&&c.push("".concat(b,"=").concat(a[b]))}),c.join("&")):""}}},function(a){a.O(0,[805,494,307,411,266,886,602,723,774,888,179],function(){var b;return a(a.s=1289)}),_N_E=a.O()}])